<!-- events/templates/admin_dashboard.html -->

{% extends 'admin/base_site.html' %}

{% block content %}
<style>
    .dashboard-container {
    display: flex;
    flex-wrap: nowrap;
    justify-content: space-around;
    padding: 20px;
    overflow-x: auto;
}

.chart-wrapper {
    width: 300px;
    margin: 0 10px;
}
</style>
<h1>Admin Dashboard</h1>
<div class="dashboard-container">
    <div class="chart-wrapper">
        <h3>User Growth</h3>
        <canvas id="userTrendChart"></canvas>
    </div>
    <div class="chart-wrapper">
        <h3>Events Distribution</h3>
        <canvas id="eventPieChart"></canvas>
    </div>
    <div class="chart-wrapper">
        <h3>Publications Distribution</h3>
        <canvas id="publicationPieChart"></canvas>
    </div>
    <div class="chart-wrapper">
        <h3>Formations Distribution</h3>
        <canvas id="formationPieChart"></canvas>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // User Growth Trend
    var userTrendChart = new Chart(document.getElementById('userTrendChart'), {
        type: 'line',
        data: {
            labels: {{ user_dates|safe }},
            datasets: [{
                label: 'Users Count Over Time',
                data: {{ user_counts|safe }},
                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1,
                fill: true
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // Events Distribution
    var eventPieChart = new Chart(document.getElementById('eventPieChart'), {
        type: 'pie',
        data: {
            labels: ['Events'],
            datasets: [{
                label: 'Events Count',
                data: [{{ event_count }}],
                backgroundColor: ['rgba(255, 99, 132, 0.2)'],
                borderColor: ['rgba(255, 99, 132, 1)'],
                borderWidth: 1
            }]
        }
    });

    // Publications Distribution
    var publicationPieChart = new Chart(document.getElementById('publicationPieChart'), {
        type: 'pie',
        data: {
            labels: ['Publications'],
            datasets: [{
                label: 'Publications Count',
                data: [{{ publication_count }}],
                backgroundColor: ['rgba(75, 192, 192, 0.2)'],
                borderColor: ['rgba(75, 192, 192, 1)'],
                borderWidth: 1
            }]
        }
    });

    // Formations Distribution
    var formationPieChart = new Chart(document.getElementById('formationPieChart'), {
        type: 'pie',
        data: {
            labels: ['Formations'],
            datasets: [{
                label: 'Formations Count',
                data: [{{ formation_count }}],
                backgroundColor: ['rgba(153, 102, 255, 0.2)'],
                borderColor: ['rgba(153, 102, 255, 1)'],
                borderWidth: 1
            }]
        }
    });
</script>
{% endblock %}
